// d3-dag Version 0.8.1. Copyright 2021 Erik Brinkman.
var d3 = Object.assign(d3 || {}, (() => {
var d3=(()=>{var si=Object.create;var ut=Object.defineProperty;var oi=Object.getOwnPropertyDescriptor;var ai=Object.getOwnPropertyNames;var hi=Object.getPrototypeOf,li=Object.prototype.hasOwnProperty;var fe=t=>ut(t,"__esModule",{value:!0});var ue=t=>{if(typeof require!="undefined")return require(t);throw new Error('Dynamic require of "'+t+'" is not supported')};var A=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),fi=(t,e)=>{fe(t);for(var r in e)ut(t,r,{get:e[r],enumerable:!0})},ui=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ai(e))!li.call(t,i)&&i!=="default"&&ut(t,i,{get:()=>e[i],enumerable:!(r=oi(e,i))||r.enumerable});return t},rt=t=>ui(fe(ut(t!=null?si(hi(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var de=A((nn,ce)=>{"use strict";function R(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}R.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};R.prototype.get=function(e){return this.peekAt(e)};R.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};R.prototype.peekFront=function(){return this.peek()};R.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(R.prototype,"length",{get:function(){return this.size()}});R.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};R.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};R.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};R.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};R.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};R.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<i/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};R.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||r<1)){if(i<0&&(i+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=o)return n=this.toArray(),this.clear(),n;i+r>o&&(r=o-i);var h;for(n=new Array(r),h=0;h<r;h++)n[h]=this._list[this._head+i+h&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,h=r;h>0;h--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+a&this._capacityMask,h=r-1;h>0;h--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+r+a&this._capacityMask,h=e;h>0;h--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+a&this._capacityMask,h=o-(r+e);h>0;h--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};R.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,h=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._head=this._head+i+u&this._capacityMask);h>l;)this.unshift(arguments[--h]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+r));var f=o.length;for(s=0;s<f;s++)o[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._tail=this._tail-f+u&this._capacityMask);l<h;)this.push(arguments[l++]);for(s=0;s<f;s++)this.push(o[s])}return a}else return this.remove(i,r)}};R.prototype.clear=function(){this._head=0,this._tail=0};R.prototype.isEmpty=function(){return this._head===this._tail};R.prototype.toArray=function(){return this._copyArray(!1)};R.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};R.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};R.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1};R.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};ce.exports=R});var Be=A((dn,je)=>{"use strict";var at=1e-60,Me,Ce;do at+=at,Me=1+.1*at,Ce=1+.2*at;while(Me<=1||Ce<=1);je.exports=at});var Ee=A((pn,ze)=>{"use strict";function Mi(t,e,r){let i,n;for(let s=1;s<=r;s+=1){t[s][s]=1/t[s][s],n=-t[s][s];for(let o=1;o<s;o+=1)t[o][s]*=n;if(i=s+1,r<i)break;for(let o=i;o<=r;o+=1){n=t[s][o],t[s][o]=0;for(let a=1;a<=s;a+=1)t[a][o]+=n*t[a][s]}}}ze.exports=Mi});var Se=A((vn,Ve)=>{"use strict";function Ci(t,e,r,i){let n,s;for(n=1;n<=r;n+=1){s=0;for(let o=1;o<n;o+=1)s+=t[o][n]*i[o];i[n]=(i[n]-s)/t[n][n]}for(let o=1;o<=r;o+=1){n=r+1-o,i[n]/=t[n][n],s=-i[n];for(let a=1;a<n;a+=1)i[a]+=s*t[a][n]}}Ve.exports=Ci});var qe=A((gn,Oe)=>{"use strict";function ji(t,e,r,i){let n,s,o;for(let a=1;a<=r;a+=1){if(i[1]=a,o=0,n=a-1,n<1){if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}else{for(let h=1;h<=n;h+=1){s=t[h][a];for(let u=1;u<h;u+=1)s-=t[u][a]*t[u][h];s/=t[h][h],t[h][a]=s,o+=s*s}if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}i[1]=0}}Oe.exports=ji});var Te=A((mn,Ae)=>{"use strict";var Ft=Be(),Bi=Ee(),zi=Se(),Ei=qe();function Vi(t,e,r,i,n,s,o,a,h,u,l,f,c,v=0,m,d,I){let y,g,b,_,w,x,E,C,z,j,V,S,O,T,$=Math.min(i,l),q=2*i+$*($+5)/2+2*l+1;for(let p=1;p<=i;p+=1)d[p]=e[p];for(let p=i+1;p<=q;p+=1)d[p]=0;for(let p=1;p<=l;p+=1)c[p]=0,s[p]=0;let G=[];if(I[1]===0){if(Ei(t,r,i,G),G[1]!==0){I[1]=2;return}zi(t,r,i,e),Bi(t,r,i)}else{for(let p=1;p<=i;p+=1){n[p]=0;for(let B=1;B<=p;B+=1)n[p]+=t[B][p]*e[B]}for(let p=1;p<=i;p+=1){e[p]=0;for(let B=p;B<=i;B+=1)e[p]+=t[p][B]*n[B]}}o[1]=0;for(let p=1;p<=i;p+=1){n[p]=e[p],o[1]+=d[p]*n[p],d[p]=0;for(let B=p+1;B<=i;B+=1)t[B][p]=0}o[1]=-o[1]/2,I[1]=0;let L=i,H=L+i,P=H+$,Q=P+$+1,X=Q+$*($+1)/2,$t=X+l;for(let p=1;p<=l;p+=1){x=0;for(let B=1;B<=i;B+=1)x+=a[B][p]*a[B][p];d[$t+p]=Math.sqrt(x)}_=v,m[1]=0,m[2]=0;function ei(){m[1]+=1,q=X;for(let p=1;p<=l;p+=1){q+=1,x=-h[p];for(let B=1;B<=i;B+=1)x+=a[B][p]*n[B];if(Math.abs(x)<Ft&&(x=0),p>f)d[q]=x;else if(d[q]=-Math.abs(x),x>0){for(let B=1;B<=i;B+=1)a[B][p]=-a[B][p];h[p]=-h[p]}}for(let p=1;p<=_;p+=1)d[X+c[p]]=0;b=0,w=0;for(let p=1;p<=l;p+=1)d[X+p]<w*d[$t+p]&&(b=p,w=d[X+p]/d[$t+p]);if(b===0){for(let p=1;p<=_;p+=1)s[c[p]]=d[P+p];return 999}return 0}function ri(){for(let p=1;p<=i;p+=1){x=0;for(let B=1;B<=i;B+=1)x+=t[B][p]*a[B][b];d[p]=x}y=L;for(let p=1;p<=i;p+=1)d[y+p]=0;for(let p=_+1;p<=i;p+=1)for(let B=1;B<=i;B+=1)d[y+B]=d[y+B]+t[B][p]*d[p];S=!0;for(let p=_;p>=1;p-=1){x=d[p],q=Q+p*(p+3)/2,y=q-p;for(let B=p+1;B<=_;B+=1)x-=d[q]*d[H+B],q+=B;x/=d[y],d[H+p]=x,!(c[p]<=f)&&(x<=0||(S=!1,g=p))}if(!S){E=d[P+g]/d[H+g];for(let p=1;p<=_;p+=1)c[p]<=f||d[H+p]<=0||(w=d[P+p]/d[H+p],w<E&&(E=w,g=p))}x=0;for(let p=L+1;p<=L+i;p+=1)x+=d[p]*d[p];if(Math.abs(x)<=Ft){if(S)return I[1]=1,999;for(let p=1;p<=_;p+=1)d[P+p]=d[P+p]-E*d[H+p];return d[P+_+1]=d[P+_+1]+E,700}x=0;for(let p=1;p<=i;p+=1)x+=d[L+p]*a[p][b];C=-d[X+b]/x,O=!0,S||E<C&&(C=E,O=!1);for(let p=1;p<=i;p+=1)n[p]+=C*d[L+p],Math.abs(n[p])<Ft&&(n[p]=0);o[1]+=C*x*(C/2+d[P+_+1]);for(let p=1;p<=_;p+=1)d[P+p]=d[P+p]-C*d[H+p];if(d[P+_+1]=d[P+_+1]+C,O){_+=1,c[_]=b,q=Q+(_-1)*_/2+1;for(let p=1;p<=_-1;p+=1)d[q]=d[p],q+=1;if(_===i)d[q]=d[i];else{for(let p=i;p>=_+1;p-=1)if(d[p]!==0&&(z=Math.max(Math.abs(d[p-1]),Math.abs(d[p])),j=Math.min(Math.abs(d[p-1]),Math.abs(d[p])),d[p-1]>=0?w=Math.abs(z*Math.sqrt(1+j*j/(z*z))):w=-Math.abs(z*Math.sqrt(1+j*j/(z*z))),z=d[p-1]/w,j=d[p]/w,z!==1))if(z===0){d[p-1]=j*w;for(let B=1;B<=i;B+=1)w=t[B][p-1],t[B][p-1]=t[B][p],t[B][p]=w}else{d[p-1]=w,V=j/(1+z);for(let B=1;B<=i;B+=1)w=z*t[B][p-1]+j*t[B][p],t[B][p]=V*(t[B][p-1]+w)-t[B][p],t[B][p-1]=w}d[q]=d[_]}}else{x=-h[b];for(let p=1;p<=i;p+=1)x+=n[p]*a[p][b];if(b>f)d[X+b]=x;else if(d[X+b]=-Math.abs(x),x>0){for(let p=1;p<=i;p+=1)a[p][b]=-a[p][b];h[b]=-h[b]}return 700}return 0}function ii(){if(q=Q+g*(g+1)/2+1,y=q+g,d[y]===0||(z=Math.max(Math.abs(d[y-1]),Math.abs(d[y])),j=Math.min(Math.abs(d[y-1]),Math.abs(d[y])),d[y-1]>=0?w=Math.abs(z*Math.sqrt(1+j*j/(z*z))):w=-Math.abs(z*Math.sqrt(1+j*j/(z*z))),z=d[y-1]/w,j=d[y]/w,z===1))return 798;if(z===0){for(let p=g+1;p<=_;p+=1)w=d[y-1],d[y-1]=d[y],d[y]=w,y+=p;for(let p=1;p<=i;p+=1)w=t[p][g],t[p][g]=t[p][g+1],t[p][g+1]=w}else{V=j/(1+z);for(let p=g+1;p<=_;p+=1)w=z*d[y-1]+j*d[y],d[y]=V*(d[y-1]+w)-d[y],d[y-1]=w,y+=p;for(let p=1;p<=i;p+=1)w=z*t[p][g]+j*t[p][g+1],t[p][g+1]=V*(t[p][g]+w)-t[p][g+1],t[p][g]=w}return 0}function ni(){y=q-g;for(let p=1;p<=g;p+=1)d[y]=d[q],q+=1,y+=1;return d[P+g]=d[P+g+1],c[g]=c[g+1],g+=1,g<_?797:0}function le(){return d[P+_]=d[P+_+1],d[P+_+1]=0,c[_]=0,_-=1,m[2]+=1,0}for(T=0;;){if(T=ei(),T===999)return;for(;T=ri(),T!==0;){if(T===999)return;if(T===700)if(g===_)le();else{for(;ii(),T=ni(),T===797;);le()}}}}Ae.exports=Vi});var ke=A(Ne=>{"use strict";var Si=Te();function Oi(t,e,r,i=[],n=0,s=[0,0]){let o=[],a=[],h=[],u=[],l=[],f=[],c="",v=t.length-1,m=r[1].length-1;if(!i)for(let y=1;y<=m;y+=1)i[y]=0;if(v!==t[1].length-1&&(c="Dmat is not symmetric!"),v!==e.length-1&&(c="Dmat and dvec are incompatible!"),v!==r.length-1&&(c="Amat and dvec are incompatible!"),m!==i.length-1&&(c="Amat and bvec are incompatible!"),(n>m||n<0)&&(c="Value of meq is invalid!"),c!=="")return{message:c};for(let y=1;y<=m;y+=1)a[y]=0,u[y]=0;let d=0,I=Math.min(v,m);for(let y=1;y<=v;y+=1)h[y]=0;o[1]=0;for(let y=1;y<=2*v+I*(I+5)/2+2*m+1;y+=1)l[y]=0;for(let y=1;y<=2;y+=1)f[y]=0;return Si(t,e,v,v,h,u,o,r,i,v,m,n,a,d,f,l,s),s[1]===1&&(c="constraints are inconsistent, no solution!"),s[1]===2&&(c="matrix D in quadratic function is not positive definite!"),{solution:h,Lagrangian:u,value:o,unconstrained_solution:e,iterations:f,iact:a,message:c}}Ne.solveQP=Oi});var $e=A((xn,Re)=>{"use strict";Re.exports=ke()});var Ut=A((Cn,Le)=>{function Fe(t,e,r,i){this.feasible=r,this.evaluation=e,this.bounded=i,this._tableau=t}Le.exports=Fe;Fe.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,r=e.varIndexByRow,i=e.variablesPerIndex,n=e.matrix,s=e.rhsColumn,o=e.height-1,a=Math.round(1/e.precision),h=1;h<=o;h+=1){var u=r[h],l=i[u];if(!(l===void 0||l.isSlack===!0)){var f=n[h][s];t[l.id]=Math.round((Number.EPSILON+f)*a)/a}}return t}});var We=A((jn,Ge)=>{var Ue=Ut();function It(t,e,r,i,n){Ue.call(this,t,e,r,i),this.iter=n}Ge.exports=It;It.prototype=Object.create(Ue.prototype);It.constructor=It});var J=A((Bn,He)=>{var Ni=Ut(),ki=We();function Z(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}He.exports=Z;Z.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function Gt(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var r=0;r<e;r+=1)this.reducedCosts[r]=0}Gt.prototype.copy=function(){var t=new Gt(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t};Z.prototype.setOptionalObjective=function(t,e,r){var i=this.objectivesByPriority[t];if(i===void 0){var n=Math.max(this.width,e+1);i=new Gt(t,n),this.objectivesByPriority[t]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort(function(s,o){return s.priority-o.priority})}i.reducedCosts[e]=r};Z.prototype.initialize=function(t,e,r,i){this.variables=r,this.unrestrictedVars=i,this.width=t,this.height=e;for(var n=new Array(t),s=0;s<t;s++)n[s]=0;this.matrix=new Array(e);for(var o=0;o<e;o++)this.matrix[o]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars};Z.prototype._resetMatrix=function(){var t=this.model.variables,e=this.model.constraints,r=t.length,i=e.length,n,s,o=this.matrix[0],a=this.model.isMinimization===!0?-1:1;for(n=0;n<r;n+=1){var h=t[n],u=h.priority,l=a*h.cost;u===0?o[n+1]=l:this.setOptionalObjective(u,n+1,l),s=t[n].index,this.rowByVarIndex[s]=-1,this.colByVarIndex[s]=n+1,this.varIndexByCol[n+1]=s}for(var f=1,c=0;c<i;c+=1){var v=e[c],m=v.index;this.rowByVarIndex[m]=f,this.colByVarIndex[m]=-1,this.varIndexByRow[f]=m;var d,I,y,g=v.terms,b=g.length,_=this.matrix[f++];if(v.isUpperBound){for(d=0;d<b;d+=1)I=g[d],y=this.colByVarIndex[I.variable.index],_[y]=I.coefficient;_[0]=v.rhs}else{for(d=0;d<b;d+=1)I=g[d],y=this.colByVarIndex[I.variable.index],_[y]=-I.coefficient;_[0]=-v.rhs}}};Z.prototype.setModel=function(t){this.model=t;var e=t.nVariables+1,r=t.nConstraints+1;return this.initialize(e,r,t.variables,t.unrestrictedVariables),this._resetMatrix(),this};Z.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t};Z.prototype.density=function(){for(var t=0,e=this.matrix,r=0;r<this.height;r++)for(var i=e[r],n=0;n<this.width;n++)i[n]!==0&&(t+=1);return t/(this.height*this.width)};Z.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn],r=Math.round((Number.EPSILON+e)*t)/t;this.evaluation=r,this.simplexIters===0&&(this.bestPossibleEval=r)};Z.prototype.getSolution=function(){var t=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new ki(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new Ni(this,t,this.feasible,this.bounded)}});var Je=A(()=>{var ht=J();ht.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this};ht.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],r=this.matrix,i=this.rhsColumn,n=this.width-1,s=this.height-1,o,a=0;;){for(var h=0,u=-this.precision,l=1;l<=s;l++){o=this.unrestrictedVars[this.varIndexByRow[l]]===!0;var f=r[l][i];f<u&&(u=f,h=l)}if(h===0)return this.feasible=!0,a;for(var c=0,v=-1/0,m=r[0],d=r[h],I=1;I<=n;I++){var y=d[I];if(o=this.unrestrictedVars[this.varIndexByCol[I]]===!0,o||y<-this.precision){var g=-m[I]/y;v<g&&(v=g,c=I)}}if(c===0)return this.feasible=!1,a;if(t){e.push([this.varIndexByRow[h],this.varIndexByCol[c]]);var b=this.checkForCycles(e);if(b.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+b[0]),this.model.messages.push("Length :"+b[1]),this.feasible=!1,a}this.pivot(h,c),a+=1}};ht.prototype.phase2=function(){for(var t=this.model.checkForCycles,e=[],r=this.matrix,i=this.rhsColumn,n=this.width-1,s=this.height-1,o=this.precision,a=this.optionalObjectives.length,h=null,u=0,l,f;;){var c=r[this.costRowIndex];a>0&&(h=[]);for(var v=0,m=o,d=!1,I=1;I<=n;I++){if(l=c[I],f=this.unrestrictedVars[this.varIndexByCol[I]]===!0,a>0&&-o<l&&l<o){h.push(I);continue}if(f&&l<0){-l>m&&(m=-l,v=I,d=!0);continue}l>m&&(m=l,v=I,d=!1)}if(a>0)for(var y=0;v===0&&h.length>0&&y<a;){var g=[],b=this.optionalObjectives[y].reducedCosts;m=o;for(var _=0;_<h.length;_++){if(I=h[_],l=b[I],f=this.unrestrictedVars[this.varIndexByCol[I]]===!0,-o<l&&l<o){g.push(I);continue}if(f&&l<0){-l>m&&(m=-l,v=I,d=!0);continue}l>m&&(m=l,v=I,d=!1)}h=g,y+=1}if(v===0)return this.setEvaluation(),this.simplexIters+=1,u;for(var w=0,x=1/0,E=this.varIndexByRow,C=1;C<=s;C++){var z=r[C],j=z[i],V=z[v];if(!(-o<V&&V<o)){if(V>0&&o>j&&j>-o){x=0,w=C;break}var S=d?-j/V:j/V;S>o&&x>S&&(x=S,w=C)}}if(x===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[v],u;if(t){e.push([this.varIndexByRow[w],this.varIndexByCol[v]]);var O=this.checkForCycles(e);if(O.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+O[0]),this.model.messages.push("Length :"+O[1]),this.feasible=!1,u}this.pivot(w,v,!0),u+=1}};var Wt=[];ht.prototype.pivot=function(t,e){var r=this.matrix,i=r[t][e],n=this.height-1,s=this.width-1,o=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=o,this.rowByVarIndex[a]=t,this.rowByVarIndex[o]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[o]=e;for(var h=r[t],u=0,l=0;l<=s;l++)h[l]>=-1e-16&&h[l]<=1e-16?h[l]=0:(h[l]/=i,Wt[u]=l,u+=1);h[e]=1/i;for(var f,c,v,m=this.precision,d=0;d<=n;d++)if(d!==t&&!(r[d][e]>=-1e-16&&r[d][e]<=1e-16)){var I=r[d];if(f=I[e],f>=-1e-16&&f<=1e-16)f!==0&&(I[e]=0);else{for(c=0;c<u;c++)l=Wt[c],v=h[l],v>=-1e-16&&v<=1e-16?v!==0&&(h[l]=0):I[l]=I[l]-f*v;I[e]=-f/i}}var y=this.optionalObjectives.length;if(y>0)for(var g=0;g<y;g+=1){var b=this.optionalObjectives[g].reducedCosts;if(f=b[e],f!==0){for(c=0;c<u;c++)l=Wt[c],v=h[l],v!==0&&(b[l]=b[l]-f*v);b[e]=-f/i}}};ht.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var r=e+1;r<t.length;r++){var i=t[e],n=t[r];if(i[0]===n[0]&&i[1]===n[1]){if(r-e>t.length-r)break;for(var s=!0,o=1;o<r-e;o++){var a=t[e+o],h=t[r+o];if(a[0]!==h[0]||a[1]!==h[1]){s=!1;break}}if(s)return[e,r-e]}}return[]}});var Mt=A((Vn,Ke)=>{function Ht(t,e,r,i){this.id=t,this.cost=e,this.index=r,this.value=0,this.priority=i}function Ze(t,e,r,i){Ht.call(this,t,e,r,i)}Ze.prototype.isInteger=!0;function Jt(t,e){Ht.call(this,t,0,e,0)}Jt.prototype.isSlack=!0;function Ye(t,e){this.variable=t,this.coefficient=e}function Xe(t,e,r){return r===0||r==="required"?null:(e=e||1,r=r||1,t.isMinimization===!1&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,r))}function tt(t,e,r,i){this.slack=new Jt("s"+r,r),this.index=r,this.model=i,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}tt.prototype.addTerm=function(t,e){var r=e.index,i=this.termsByVarIndex[r];if(i===void 0)i=new Ye(e,t),this.termsByVarIndex[r]=i,this.terms.push(i),this.isUpperBound===!0&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var n=i.coefficient+t;this.setVariableCoefficient(n,e)}return this};tt.prototype.removeTerm=function(t){return this};tt.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;this.isUpperBound===!0&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this};tt.prototype.setVariableCoefficient=function(t,e){var r=e.index;if(r===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var i=this.termsByVarIndex[r];if(i===void 0)this.addTerm(t,e);else if(t!==i.coefficient){var n=t-i.coefficient;this.isUpperBound===!0&&(n=-n),i.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this};tt.prototype.relax=function(t,e){this.relaxation=Xe(this.model,t,e),this._relax(this.relaxation)};tt.prototype._relax=function(t){t!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))};function it(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}it.prototype.isEquality=!0;it.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this};it.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this};it.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t};it.prototype.relax=function(t,e){this.relaxation=Xe(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};Ke.exports={Constraint:tt,Variable:Ht,IntegerVariable:Ze,SlackVariable:Jt,Equality:it,Term:Ye}});var Qe=A(()=>{var Ct=J(),Zt=Mt().SlackVariable;Ct.prototype.addCutConstraints=function(t){for(var e=t.length,r=this.height,i=r+e,n=r;n<i;n+=1)this.matrix[n]===void 0&&(this.matrix[n]=this.matrix[n-1].slice());this.height=i,this.nVars=this.width+this.height-2;for(var s,o=this.width-1,a=0;a<e;a+=1){var h=t[a],u=r+a,l=h.type==="min"?-1:1,f=h.varIndex,c=this.rowByVarIndex[f],v=this.matrix[u];if(c===-1){for(v[this.rhsColumn]=l*h.value,s=1;s<=o;s+=1)v[s]=0;v[this.colByVarIndex[f]]=l}else{var m=this.matrix[c],d=m[this.rhsColumn];for(v[this.rhsColumn]=l*(h.value-d),s=1;s<=o;s+=1)v[s]=-l*m[s]}var I=this.getNewElementIndex();this.varIndexByRow[u]=I,this.rowByVarIndex[I]=u,this.colByVarIndex[I]=-1,this.variablesPerIndex[I]=new Zt("s"+I,I),this.nVars+=1}};Ct.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.model,r=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[t]];if(!i.isInteger)return!1;var n=r[t][this.rhsColumn],s=n-Math.floor(n);if(s<this.precision||1-this.precision<s)return!1;var o=this.height;r[o]=r[o-1].slice(),this.height+=1,this.nVars+=1;var a=this.getNewElementIndex();this.varIndexByRow[o]=a,this.rowByVarIndex[a]=o,this.colByVarIndex[a]=-1,this.variablesPerIndex[a]=new Zt("s"+a,a),r[o][this.rhsColumn]=Math.floor(n);for(var h=1;h<this.varIndexByCol.length;h+=1){var u=this.variablesPerIndex[this.varIndexByCol[h]];if(!u.isInteger)r[o][h]=Math.min(0,r[t][h]/(1-s));else{var l=r[t][h],f=Math.floor(l)+Math.max(0,l-Math.floor(l)-s)/(1-s);r[o][h]=f}}for(var c=0;c<this.width;c+=1)r[o][c]-=r[t][c];return!0};Ct.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.model,r=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[t]];if(!i.isInteger)return!1;var n=r[t][this.rhsColumn],s=n-Math.floor(n);if(s<this.precision||1-this.precision<s)return!1;var o=this.height;r[o]=r[o-1].slice(),this.height+=1,this.nVars+=1;var a=this.getNewElementIndex();this.varIndexByRow[o]=a,this.rowByVarIndex[a]=o,this.colByVarIndex[a]=-1,this.variablesPerIndex[a]=new Zt("s"+a,a),r[o][this.rhsColumn]=-s;for(var h=1;h<this.varIndexByCol.length;h+=1){var u=this.variablesPerIndex[this.varIndexByCol[h]],l=r[t][h],f=l-Math.floor(l);u.isInteger?f<=s?r[o][h]=-f:r[o][h]=-(1-f)*s/f:l>=0?r[o][h]=-l:r[o][h]=l*s/(1-s)}return!0};Ct.prototype.applyMIRCuts=function(){}});var tr=A(()=>{var Y=J();Y.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(e===-1){for(var r=this.colByVarIndex[t],i=1;i<this.height;i+=1){var n=this.matrix[i][r];if(n<-this.precision||this.precision<n){e=i;break}}this.pivot(e,r)}return e};Y.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(e===-1){for(var r=this.rowByVarIndex[t],i=this.matrix[r],n=1;n<this.height;n+=1){var s=i[n];if(s<-this.precision||this.precision<s){e=n;break}}this.pivot(r,e)}return e};Y.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),r=0;r<t;r+=1){var i=this.variables[r],n=i.index,s=this.rowByVarIndex[n];if(s===-1)i.value=0;else{var o=this.matrix[s][this.rhsColumn];i.value=Math.round((o+Number.EPSILON)*e)/e}}};Y.prototype.updateRightHandSide=function(t,e){var r=this.height-1,i=this.rowByVarIndex[t.index];if(i===-1){for(var n=this.colByVarIndex[t.index],s=0;s<=r;s+=1){var o=this.matrix[s];o[this.rhsColumn]-=e*o[n]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var u=this.optionalObjectives[h].reducedCosts;u[this.rhsColumn]-=e*u[n]}}else this.matrix[i][this.rhsColumn]-=e};Y.prototype.updateConstraintCoefficient=function(t,e,r){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(n===-1)for(var s=this.rowByVarIndex[e.index],o=0;o<this.width;o+=1)this.matrix[i][o]+=r*this.matrix[s][o];else this.matrix[i][n]-=r};Y.prototype.updateCost=function(t,e){var r=t.index,i=this.width-1,n=this.colByVarIndex[r];if(n===-1){var s=this.matrix[this.rowByVarIndex[r]],o;if(t.priority===0){var a=this.matrix[0];for(o=0;o<=i;o+=1)a[o]+=e*s[o]}else{var h=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=i;o+=1)h[o]+=e*s[o]}}else this.matrix[0][n]-=e};Y.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,r=this.height,i=this.matrix[r];i===void 0&&(i=this.matrix[0].slice(),this.matrix[r]=i);for(var n=this.width-1,s=0;s<=n;s+=1)i[s]=0;i[this.rhsColumn]=e*t.rhs;for(var o=t.terms,a=o.length,h=0;h<a;h+=1){var u=o[h],l=u.coefficient,f=u.variable.index,c=this.rowByVarIndex[f];if(c===-1)i[this.colByVarIndex[f]]+=e*l;else{var v=this.matrix[c],m=v[this.rhsColumn];for(s=0;s<=n;s+=1)i[s]-=e*l*v[s]}}var d=t.index;this.varIndexByRow[r]=d,this.rowByVarIndex[d]=r,this.colByVarIndex[d]=-1,this.height+=1};Y.prototype.removeConstraint=function(t){var e=t.index,r=this.height-1,i=this._putInBase(e),n=this.matrix[r];this.matrix[r]=this.matrix[i],this.matrix[i]=n,this.varIndexByRow[i]=this.varIndexByRow[r],this.varIndexByRow[r]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1};Y.prototype.addVariable=function(t){var e=this.height-1,r=this.width,i=this.model.isMinimization===!0?-t.cost:t.cost,n=t.priority,s=this.optionalObjectives.length;if(s>0)for(var o=0;o<s;o+=1)this.optionalObjectives[o].reducedCosts[r]=0;n===0?this.matrix[0][r]=i:(this.setOptionalObjective(n,r,i),this.matrix[0][r]=0);for(var a=1;a<=e;a+=1)this.matrix[a][r]=0;var h=t.index;this.varIndexByCol[r]=h,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=r,this.width+=1};Y.prototype.removeVariable=function(t){var e=t.index,r=this._takeOutOfBase(e),i=this.width-1;if(r!==i){for(var n=this.height-1,s=0;s<=n;s+=1){var o=this.matrix[s];o[r]=o[i]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var u=this.optionalObjectives[h].reducedCosts;u[r]=u[i]}var l=this.varIndexByCol[i];this.varIndexByCol[r]=l,this.colByVarIndex[l]=r}this.varIndexByCol[i]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1}});var er=A(()=>{var Ri=J();Ri.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var r=5,i="",n=[" "],s,o,a,h,u,l,f,c,v,m,d,I,y;for(o=1;o<this.width;o+=1)l=this.varIndexByCol[o],u=this.variablesPerIndex[l],u===void 0?f="c"+l:f=u.id,c=f.length,v=Math.abs(c-5),m=" ",d="	",c>5?m+=" ":d+="	",n[o]=m,i+=d+f;console.log(i);var g,b=this.matrix[this.costRowIndex],_="	";for(s=1;s<this.width;s+=1)g="	",_+=g,_+=n[s],_+=b[s].toFixed(r);for(g="	",_+=g+n[0]+b[0].toFixed(r),console.log(_+"	Z"),h=1;h<this.height;h+=1){for(I=this.matrix[h],y="	",o=1;o<this.width;o+=1)g="	",y+=g+n[o]+I[o].toFixed(r);g="	",y+=g+n[0]+I[0].toFixed(r),l=this.varIndexByRow[h],u=this.variablesPerIndex[l],u===void 0?f="c"+l:f=u.id,console.log(y+"	"+f)}console.log("");var w=this.optionalObjectives.length;if(w>0){console.log("    Optional objectives:");for(var x=0;x<w;x+=1){var E=this.optionalObjectives[x].reducedCosts,C="";for(s=1;s<this.width;s+=1)g=E[s]<0?"":" ",C+=g,C+=n[s],C+=E[s].toFixed(r);g=E[0]<0?"":" ",C+=g+n[0]+E[0].toFixed(r),console.log(C+" z"+x)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}});var rr=A(()=>{var jt=J();jt.prototype.copy=function(){var t=new jt(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],r=0;r<this.optionalObjectives.length;r++)e[r]=this.optionalObjectives[r].copy();t.optionalObjectives=e;for(var i=this.matrix,n=new Array(this.height),s=0;s<this.height;s++)n[s]=i[s].slice();return t.matrix=n,t};jt.prototype.save=function(){this.savedState=this.copy()};jt.prototype.restore=function(){if(this.savedState!==null){var t=this.savedState,e=t.matrix;this.nVars=t.nVars,this.model=t.model,this.variables=t.variables,this.variablesPerIndex=t.variablesPerIndex,this.unrestrictedVars=t.unrestrictedVars,this.lastElementIndex=t.lastElementIndex,this.width=t.width,this.height=t.height;var r,i;for(r=0;r<this.height;r+=1){var n=e[r],s=this.matrix[r];for(i=0;i<this.width;i+=1)s[i]=n[i]}var o=t.varIndexByRow;for(i=0;i<this.height;i+=1)this.varIndexByRow[i]=o[i];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=t.varIndexByCol;for(r=0;r<this.width;r+=1)this.varIndexByCol[r]=a[r];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var h=t.rowByVarIndex,u=t.colByVarIndex,l=0;l<this.nVars;l+=1)this.rowByVarIndex[l]=h[l],this.colByVarIndex[l]=u[l];if(t.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var f=0;f<t.optionalObjectives.length;f++){var c=t.optionalObjectives[f].copy();this.optionalObjectives[f]=c,this.optionalObjectivePerPriority[c.priority]=c}}}}});var sr=A(()=>{var ir=J();function nr(t,e){this.index=t,this.value=e}ir.prototype.getMostFractionalVar=function(){for(var t=0,e=null,r=null,i=.5,n=this.model.integerVariables,s=n.length,o=0;o<s;o++){var a=n[o].index,h=this.rowByVarIndex[a];if(h!==-1){var u=this.matrix[h][this.rhsColumn],l=Math.abs(u-Math.round(u));t<l&&(t=l,e=a,r=u)}}return new nr(e,r)};ir.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,r=null,i=this.model.integerVariables,n=i.length,s=0;s<n;s++){var o=i[s],a=o.index,h=this.rowByVarIndex[a];if(h!==-1){var u=this.matrix[h][this.rhsColumn];if(Math.abs(u-Math.round(u))>this.precision){var l=o.cost;t>l&&(t=l,e=a,r=u)}}}return new nr(e,r)}});var or=A(()=>{var Yt=J();Yt.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var r=this.matrix[e][this.rhsColumn];r=r-Math.floor(r),r<this.precision&&-r<this.precision&&(t+=1)}return t};Yt.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,r=0;r<e;r++){var i=this.rowByVarIndex[t[r].index];if(i!==-1){var n=this.matrix[i][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0};Yt.prototype.computeFractionalVolume=function(t){for(var e=-1,r=1;r<this.height;r+=1)if(this.variablesPerIndex[this.varIndexByRow[r]].isInteger){var i=this.matrix[r][this.rhsColumn];i=Math.abs(i);var n=Math.min(i-Math.floor(i),Math.floor(i+1));if(n<this.precision){if(!t)return 0}else e===-1?e=i:e*=i}return e===-1?0:e}});var hr=A((Ln,ar)=>{Je();Qe();tr();er();rr();sr();or();ar.exports=J()});var Kt=A(()=>{var lr=J();function fr(t,e,r){this.type=t,this.varIndex=e,this.value=r}function Xt(t,e){this.relaxedEvaluation=t,this.cuts=e}function $i(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}lr.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var r=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var i=this.computeFractionalVolume(!0);i>=.9*r&&(e=!1)}};lr.prototype.branchAndCut=function(){var t=[],e=0,r=this.model.tolerance,i=!0,n=1e99;this.model.timeout&&(n=Date.now()+this.model.timeout);for(var s=1/0,o=null,a=[],h=0;h<this.optionalObjectives.length;h+=1)a.push(1/0);var u=new Xt(-1/0,[]),l;for(t.push(u);t.length>0&&i===!0&&Date.now()<n;)if(this.model.isMinimization?l=this.bestPossibleEval*(1+r):l=this.bestPossibleEval*(1-r),r>0&&s<l&&(i=!1),u=t.pop(),!(u.relaxedEvaluation>s)){var f=u.cuts;if(this.applyCuts(f),e++,this.feasible!==!1){var c=this.evaluation;if(!(c>s)){if(c===s){for(var v=!0,m=0;m<this.optionalObjectives.length&&!(this.optionalObjectives[m].reducedCosts[0]>a[m]);m+=1)if(this.optionalObjectives[m].reducedCosts[0]<a[m]){v=!1;break}if(v)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,e===1){this.branchAndCutIterations=e;return}o=u,s=c;for(var d=0;d<this.optionalObjectives.length;d+=1)a[d]=this.optionalObjectives[d].reducedCosts[0]}else{e===1&&this.save();for(var I=this.getMostFractionalVar(),y=I.index,g=[],b=[],_=f.length,w=0;w<_;w+=1){var x=f[w];x.varIndex===y?x.type==="min"?b.push(x):g.push(x):(g.push(x),b.push(x))}var E=Math.ceil(I.value),C=Math.floor(I.value),z=new fr("min",y,E);g.push(z);var j=new fr("max",y,C);b.push(j),t.push(new Xt(c,g)),t.push(new Xt(c,b)),t.sort($i)}}}}o!==null&&this.applyCuts(o.cuts),this.branchAndCutIterations=e}});var dr=A((Jn,cr)=>{var Pi=J(),Wn=Kt(),lt=Mt(),Bt=lt.Constraint,ur=lt.Equality,Di=lt.Variable,Fi=lt.IntegerVariable,Hn=lt.Term;function k(t,e){this.tableau=new Pi(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}cr.exports=k;k.prototype.minimize=function(){return this.isMinimization=!0,this};k.prototype.maximize=function(){return this.isMinimization=!1,this};k.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t};k.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(t)};k.prototype.smallerThan=function(t){var e=new Bt(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e};k.prototype.greaterThan=function(t){var e=new Bt(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e};k.prototype.equal=function(t){var e=new Bt(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var r=new Bt(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(r),new ur(e,r)};k.prototype.addVariable=function(t,e,r,i,n){if(typeof n=="string")switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0;break}var s=this.tableau.getNewElementIndex();e==null&&(e="v"+s),t==null&&(t=0),n==null&&(n=0);var o;return r?(o=new Fi(e,t,s,n),this.integerVariables.push(o)):o=new Di(e,t,s,n),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,i&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(o),o};k.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);if(e===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(e,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)};k.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this};k.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(e===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(e,1),this.tableauInitialized===!0&&this.tableau.removeVariable(t),this};k.prototype.updateRightHandSide=function(t,e){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(t,e),this};k.prototype.updateConstraintCoefficient=function(t,e,r){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(t,e,r),this};k.prototype.setCost=function(t,e){var r=t-e.cost;return this.isMinimization===!1&&(r=-r),e.cost=t,this.tableau.updateCost(e,r),this};k.prototype.loadJson=function(t){this.isMinimization=t.opType!=="max";for(var e=t.variables,r=t.constraints,i={},n={},s=Object.keys(r),o=s.length,a=0;a<o;a+=1){var h=s[a],u=r[h],l=u.equal,f=u.weight,c=u.priority,v=f!==void 0||c!==void 0,m,d;if(l===void 0){var I=u.min;I!==void 0&&(m=this.greaterThan(I),i[h]=m,v&&m.relax(f,c));var y=u.max;y!==void 0&&(d=this.smallerThan(y),n[h]=d,v&&d.relax(f,c))}else{m=this.greaterThan(l),i[h]=m,d=this.smallerThan(l),n[h]=d;var g=new ur(m,d);v&&g.relax(f,c)}}var b=Object.keys(e),_=b.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),this.tolerance===0&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),typeof t.options.exitOnCycles=="undefined"?this.checkForCycles=!0:this.checkForCycles=t.options.exitOnCycles);for(var w=t.ints||{},x=t.binaries||{},E=t.unrestricted||{},C=t.optimize,z=0;z<_;z+=1){var j=b[z],V=e[j],S=V[C]||0,O=!!x[j],T=!!w[j]||O,$=!!E[j],q=this.addVariable(S,j,T,$);O&&this.smallerThan(1).addTerm(1,q);var G=Object.keys(V);for(a=0;a<G.length;a+=1){var L=G[a];if(L!==C){var H=V[L],P=i[L];P!==void 0&&P.addTerm(H,q);var Q=n[L];Q!==void 0&&Q.addTerm(H,q)}}}return this};k.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length};k.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()};k.prototype.isFeasible=function(){return this.tableau.feasible};k.prototype.save=function(){return this.tableau.save()};k.prototype.restore=function(){return this.tableau.restore()};k.prototype.activateMIRCuts=function(t){this.useMIRCuts=t};k.prototype.debug=function(t){this.checkForCycles=t};k.prototype.log=function(t){return this.tableau.log(t)}});var vr=A(pr=>{pr.CleanObjectiveAttributes=function(t){var e,r,i;if(typeof t.optimize=="string")if(t.constraints[t.optimize]){e=Math.random();for(r in t.variables)t.variables[r][t.optimize]&&(t.variables[r][e]=t.variables[r][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}else return t;else{for(i in t.optimize)if(t.constraints[i])if(t.constraints[i]==="equal")delete t.optimize[i];else{e=Math.random();for(r in t.variables)t.variables[r][i]&&(t.variables[r][e]=t.variables[r][i]);t.constraints[e]=t.constraints[i],delete t.constraints[i]}return t}}});var zt=A((Yn,gr)=>{function Li(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},r={opType:"",optimize:"_obj",constraints:{},variables:{}},i={">=":"min","<=":"max","=":"equal"},n="",s=0,o=null,a="",h="",u="",l=0;typeof t=="string"&&(t=t.split(`
`));for(var f=0;f<t.length;f++)if(u="__"+f,n=t[f],s=0,o=null,e.is_objective.test(n))r.opType=n.match(/(max|min)/gi)[0],o=n.match(e.parse_lhs).map(function(m){return m.replace(/\s+/,"")}).slice(1),o.forEach(function(m){a=m.match(e.get_num),a===null?m.substr(0,1)==="-"?a=-1:a=1:a=a[0],a=parseFloat(a),h=m.match(e.get_word)[0].replace(/\;$/,""),r.variables[h]=r.variables[h]||{},r.variables[h]._obj=a});else if(e.is_int.test(n))o=n.match(e.parse_int).slice(1),r.ints=r.ints||{},o.forEach(function(m){m=m.replace(";",""),r.ints[m]=1});else if(e.is_bin.test(n))o=n.match(e.parse_bin).slice(1),r.binaries=r.binaries||{},o.forEach(function(m){m=m.replace(";",""),r.binaries[m]=1});else if(e.is_constraint.test(n)){var c=n.indexOf(":"),v=c===-1?n:n.slice(c+1);o=v.match(e.parse_lhs).map(function(m){return m.replace(/\s+/,"")}),o.forEach(function(m){a=m.match(e.get_num),a===null?m.substr(0,1)==="-"?a=-1:a=1:a=a[0],a=parseFloat(a),h=m.match(e.get_word)[0],r.variables[h]=r.variables[h]||{},r.variables[h][u]=a}),l=parseFloat(n.match(e.parse_rhs)[0]),n=i[n.match(e.parse_dir)[0]],r.constraints[u]=r.constraints[u]||{},r.constraints[u][n]=l}else e.is_unrestricted.test(n)&&(o=n.match(e.parse_int).slice(1),r.unrestricted=r.unrestricted||{},o.forEach(function(m){m=m.replace(";",""),r.unrestricted[m]=1}));return r}function Ui(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",r=[],i=1,n={max:"<=",min:">=",equal:"="},s=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType){e+=t.opType+":";for(var o in t.variables)t.variables[o][o]=t.variables[o][o]?t.variables[o][o]:1,t.variables[o][t.optimize]&&(e+=" "+t.variables[o][t.optimize]+" "+o.replace(s,"_"))}else e+="max:";e+=`;

`;for(var a in t.constraints)for(var h in t.constraints[a])if(typeof n[h]!="undefined"){for(var u in t.variables)typeof t.variables[u][a]!="undefined"&&(e+=" "+t.variables[u][a]+" "+u.replace(s,"_"));e+=" "+n[h]+" "+t.constraints[a][h],e+=`;
`}if(t.ints){e+=`

`;for(var l in t.ints)e+="int "+l.replace(s,"_")+`;
`}if(t.unrestricted){e+=`

`;for(var f in t.unrestricted)e+="unrestricted "+f.replace(s,"_")+`;
`}return e}gr.exports=function(t){return t.length?Li(t):Ui(t)}});var yr=A(Qt=>{Qt.reformat=zt();function mr(t){return t=t.replace("\\r\\n",`\r
`),t=t.split(`\r
`),t=t.filter(function(e){var r;return r=new RegExp(" 0$","gi"),!(r.test(e)===!0||(r=new RegExp("\\d$","gi"),r.test(e)===!1))}).map(function(e){return e.split(/\:{0,1} +(?=\d)/)}).reduce(function(e,r,i){return e[r[0]]=r[1],e},{}),t}Qt.solve=function(t){return new Promise(function(e,r){typeof window!="undefined"&&r("Function Not Available in Browser");var i=zt()(t);t.external||r("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||r("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||r("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||r("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on");var n=ue("fs");n.writeFile(t.external.tempName,i,function(s,o){if(s)r(s);else{var a=ue("child_process").execFile;t.external.args.push(t.external.tempName),a(t.external.binPath,t.external.args,function(h,u){if(h)if(h.code===1)e(mr(u));else{var l={"-2":"Out of Memory","1":"SUBOPTIMAL","2":"INFEASIBLE","3":"UNBOUNDED","4":"DEGENERATE","5":"NUMFAILURE","6":"USER-ABORT","7":"TIMEOUT","9":"PRESOLVED","25":"ACCURACY ERROR","255":"FILE-ERROR"},f={code:h.code,meaning:l[h.code],data:u};r(f)}else e(mr(u))})}})})}});var br=A((Kn,xr)=>{xr.exports={lpsolve:yr()}});var te=A((Qn,wr)=>{wr.exports=function(t,e){var r=e.optimize,i=JSON.parse(JSON.stringify(e.optimize)),n=Object.keys(e.optimize),s,o=0,a={},h="",u={},l=[],f,c,v,m,d;for(delete e.optimize,f=0;f<n.length;f++)i[n[f]]=0;for(f=0;f<n.length;f++){e.optimize=n[f],e.opType=r[n[f]],s=t.Solve(e,void 0,void 0,!0);for(m in n)if(!e.variables[n[m]]){s[n[m]]=s[n[m]]?s[n[m]]:0;for(v in e.variables)e.variables[v][n[m]]&&s[v]&&(s[n[m]]+=s[v]*e.variables[v][n[m]])}for(h="base",c=0;c<n.length;c++)s[n[c]]?h+="-"+(s[n[c]]*1e3|0)/1e3:h+="-0";if(!a[h]){for(a[h]=1,o++,c=0;c<n.length;c++)s[n[c]]&&(i[n[c]]+=s[n[c]]);delete s.feasible,delete s.result,l.push(s)}}for(f=0;f<n.length;f++)e.constraints[n[f]]={equal:i[n[f]]/o};e.optimize="cheater-"+Math.random(),e.opType="max";for(f in e.variables)e.variables[f].cheater=1;for(f in l)for(v in l[f])u[v]=u[v]||{min:1e99,max:-1e99};for(f in u)for(v in l)l[v][f]?(l[v][f]>u[f].max&&(u[f].max=l[v][f]),l[v][f]<u[f].min&&(u[f].min=l[v][f])):(l[v][f]=0,u[f].min=0);return s=t.Solve(e,void 0,void 0,!0),{midpoint:s,vertices:l,ranges:u}}});var Ot=A((ts,Ir)=>{var Gi=hr(),ee=dr(),Wi=Kt(),Et=Mt(),_r=vr(),Hi=Et.Constraint,Ji=Et.Variable,Zi=Et.Numeral,Yi=Et.Term,Vt=br(),St=function(){"use strict";this.Model=ee,this.branchAndCut=Wi,this.Constraint=Hi,this.Variable=Ji,this.Numeral=Zi,this.Term=Yi,this.Tableau=Gi,this.lastSolvedModel=null,this.External=Vt,this.Solve=function(t,e,r,i){if(i)for(var n in _r)t=_r[n](t);if(!t)throw new Error("Solver requires a model to operate on");if(typeof t.optimize=="object"&&Object.keys(t.optimize>1))return te()(this,t);if(t.external){var s=Object.keys(Vt);if(s=JSON.stringify(s),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+s);if(!Vt[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+s);return Vt[t.external.solver].solve(t)}else{t instanceof ee||(t=new ee(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),r)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,o._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(o.solutionSet).forEach(function(h){o.solutionSet[h]!==0&&(a[h]=o.solutionSet[h])}),a}},this.ReformatLP=zt(),this.MultiObjective=function(t){return te()(this,t)}};typeof define=="function"?define([],function(){return new St}):typeof window=="object"?window.solver=new St:typeof self=="object"&&(self.solver=new St);Ir.exports=new St});var Pr=A((As,$r)=>{"use strict";var Qi=function(t,e){return t<e};function D(t){if(!(this instanceof D))return new D(t);this.array=[],this.size=0,this.compare=t||Qi}D.prototype.clone=function(){var t=new D(this.compare);return t.size=this.size,t.array=this.array.slice(0,this.size),t};D.prototype.add=function(t){var e=this.size;this.array[this.size]=t,this.size+=1;for(var r,i;e>0&&(r=e-1>>1,i=this.array[r],!!this.compare(t,i));)this.array[e]=i,e=r;this.array[e]=t};D.prototype.heapify=function(t){this.array=t,this.size=t.length;var e;for(e=this.size>>1;e>=0;e--)this._percolateDown(e)};D.prototype._percolateUp=function(t,e){for(var r=this.array[t],i,n;t>0&&(i=t-1>>1,n=this.array[i],!(!e&&!this.compare(r,n)));)this.array[t]=n,t=i;this.array[t]=r};D.prototype._percolateDown=function(t){for(var e=this.size,r=this.size>>>1,i=this.array[t],n,s,o;t<r&&(n=(t<<1)+1,s=n+1,o=this.array[n],s<e&&this.compare(this.array[s],o)&&(n=s,o=this.array[s]),!!this.compare(o,i));)this.array[t]=o,t=n;this.array[t]=i};D.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()};D.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1};D.prototype.removeOne=function(t){if(typeof t=="function"){for(var e=0;e<this.size;e++)if(t(this.array[e]))return this._removeAt(e)}};D.prototype.removeMany=function(t,e){if(typeof t!="function"||this.size<1)return[];e=e?Math.min(e,this.size):this.size;for(var r=0,i=new Array(e),n=0,s=new Array(this.size);r<e&&!this.isEmpty();){var o=this.poll();t(o)?i[r++]=o:s[n++]=o}i.length=r;for(var a=0;a<n;)this.add(s[a++]);return i};D.prototype.peek=function(){if(this.size!=0)return this.array[0]};D.prototype.poll=function(){if(this.size!=0){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}};D.prototype.replaceTop=function(t){if(this.size!=0){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}};D.prototype.trim=function(){this.array=this.array.slice(0,this.size)};D.prototype.isEmpty=function(){return this.size===0};D.prototype.forEach=function(t){if(!(this.isEmpty()||typeof t!="function"))for(var e=0,r=this.clone();!r.isEmpty();)t(r.poll(),e++)};D.prototype.kSmallest=function(t){if(this.size==0)return[];t=Math.min(this.size,t);var e=new D(this.compare);let r=Math.min((t>0?Math.pow(2,t-1):0)+1,this.size);e.size=r,e.array=this.array.slice(0,r);for(var i=new Array(t),n=0;n<t;n++)i[n]=e.poll();return i};$r.exports=D});var en={};fi(en,{aggMeanFactory:()=>Er,aggMedianFactory:()=>se,coordCenter:()=>Wr,coordGreedy:()=>Hr,coordQuad:()=>_t,coordTopological:()=>Jr,dagConnect:()=>me,dagHierarchy:()=>vt,dagStratify:()=>_e,decrossOpt:()=>Gr,decrossTwoLayer:()=>Rt,layeringCoffmanGraham:()=>Lr,layeringLongestPath:()=>Rr,layeringSimplex:()=>qt,layeringTopological:()=>Nr,sugiyama:()=>Tr,twolayerAgg:()=>kt,twolayerOpt:()=>Yr,zherebko:()=>ti});var nt=rt(de()),pe=class{base;constructor(e){this.base=e}[Symbol.iterator](){return this.base[Symbol.iterator]()}*gconcat(...e){yield*this;for(let r of e)yield*r}concat(...e){return N(this.gconcat(...e))}*gentries(){let e=0;for(let r of this)yield[e++,r]}entries(){return N(this.gentries())}every(e){return!this.some((r,i)=>!e(r,i))}fill(e){return this.map(()=>e)}*gfilter(e){for(let[r,i]of this.gentries())e(i,r)&&(yield i)}filter(e){return N(this.gfilter(e))}find(e){return this.filter(e).shift()}findIndex(e){for(let[r,i]of this.gentries())if(e(i,r))return r;return-1}*gflatMap(e){for(let[r,i]of this.gentries())yield*e(i,r)}flatMap(e){return N(this.gflatMap(e))}forEach(e){for(let[r,i]of this.gentries())e(i,r)}includes(e,r=0){return this.indexOf(e,r)>=0}indexOf(e,r=0){if(r<0){let i=0,n=new nt.default;for(let o of this)i>=-r&&n.shift(),n.push(o),i++;let s=n.toArray().indexOf(e);return s===-1?-1:s+i+r}else{for(let[i,n]of this.gentries())if(i>=r&&n===e)return i;return-1}}join(e=","){return[...this].join(e)}*gkeys(){let e=0;for(let r of this)yield e++}keys(){return N(this.gkeys())}lastIndexOf(e,r=1/0){let i=-1;if(r<0){let n=new nt.default;for(let[s,o]of this.gentries()){o===e&&n.push(s);let a=n.peekFront();a!==void 0&&a<=s+r+1&&(n.shift(),i=a)}}else for(let[n,s]of this.gentries())n<=r&&s===e&&(i=n);return i}get length(){return this.reduce(e=>e+1,0)}*gmap(e){for(let[r,i]of this.gentries())yield e(i,r)}map(e){return N(this.gmap(e))}pop(){let e;for(e of this);return e}push(...e){return this.concat(e)}reduce(e,r){if(r===void 0){let i=e,n=!0,s;for(let[o,a]of this.gentries())n?(s=a,n=!1):s=i(s,a,o);if(n)throw new TypeError("Reduce of empty iterable with no initial value");return s}else{let i=e,n=r;for(let[s,o]of this.gentries())n=i(n,o,s);return n}}reverse(){return N([...this].reverse())}shift(){for(let e of this)return e}*gslice(e,r){for(let[i,n]of this.gentries()){if(i>=r)break;i>=e&&(yield n)}}*gnegslice(e,r){let i=new nt.default,n=e-r;for(let[s,o]of this.gentries())s>=n?(yield i.shift(),i.push(o)):s>=e&&i.push(o)}slice(e=0,r=1/0){if(e<0){let i=0,n=new nt.default;for(let a of this)i>=-e&&n.shift(),n.push(a),i++;let s=n.toArray(),o=r-i-e;return r<0?N(s.slice(0,r)):o>0?N(s.slice(0,o)):N()}else return r<0?N(this.gnegslice(e,r)):N(this.gslice(e,r))}some(e){for(let[r,i]of this.gentries())if(e(i,r))return!0;return!1}sort(e){return N([...this].sort(e))}*gsplice(e,r,...i){for(let[n,s]of this.gentries())n===e&&(yield*i),(n<e||n>=e+r)&&(yield s)}splice(e,r=0,...i){return N(this.gsplice(e,r,...i))}unshift(...e){return N(e).concat(this)}values(){return this}};function N(t=[]){return new pe(t)}function M(t){if(t!==void 0)return t;throw new Error("internal error: got unexpected undefined value")}function F(t){if(!t)throw new Error("internal error: failed assert")}function ve(t,e){e.size<t.size&&([e,t]=[t,e]);for(let r of t)if(e.has(r))return!0;return!1}function ci(){let t=new WeakSet;return(e,r)=>{if(typeof r=="object"&&r!==null){if(t.has(r))return"[circular]";t.add(r)}return r}}function U(t,...e){let[r,...i]=t;return[r].concat(...i.map((n,s)=>[JSON.stringify(e[s],ci()),n])).join("")}function*W(t){let[e,...r]=t;for(let i of r)yield[e,i],e=i}function*st(t,...e){let r=new Set,i;for(;i=e.pop();)r.has(i)||(yield i,r.add(i),e.push(...t(i)))}var ct=class{child;data;points;constructor(e,r,i=[]){this.child=e,this.data=r,this.points=i}},ge=class{source;target;data;points;constructor(e,r,i,n){this.source=e,this.target=r,this.data=i,this.points=n}},K=class{proots;constructor(e){e&&(this.proots=e)}[Symbol.iterator](){return this.idescendants()[Symbol.iterator]()}iroots(){return N(M(this.proots))}roots(){return[...this.iroots()]}*gdepth(){yield*st(r=>r.ichildren(),...this.iroots())}*gbreadth(){let e=new Set,r=this.roots(),i=[];do{i=r.reverse(),r=[];let n;for(;n=i.pop();)e.has(n)||(e.add(n),yield n,r.push(...n.ichildren()))}while(r.length)}*gbefore(){let e=new Map;for(let n of this)for(let s of n.ichildren())e.set(s,(e.get(s)||0)+1);let r=this.roots(),i;for(;i=r.pop();){yield i;for(let n of i.ichildren()){let s=M(e.get(n));s>1?e.set(n,s-1):r.push(n)}}}*gafter(){let e=this.roots(),r=new Set,i;for(;i=e.pop();)r.has(i)||(i.ichildren().every(n=>r.has(n))?(r.add(i),yield i):(e.push(i),e.push(...i.ichildren())))}idescendants(e="depth"){if(e==="depth")return N(this.gdepth());if(e==="breadth")return N(this.gbreadth());if(e==="before")return N(this.gbefore());if(e==="after")return N(this.gafter());throw new Error(`unknown iteration style: ${e}`)}descendants(e="depth"){return[...this.idescendants(e)]}ilinks(){return this.idescendants().flatMap(e=>e.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(e=>e+1,0)}sum(e){let r=new Map;for(let[i,n]of this.idescendants("after").entries()){let s=e(n,i),o=new Map;o.set(n,s);for(let a of n.ichildren()){let h=M(r.get(a));for(let[u,l]of h.entries())o.set(u,l)}n.value=N(o.values()).reduce((a,h)=>a+h),r.set(n,o)}return this}count(){let e=new Map;for(let r of this.idescendants("after"))if(r.ichildren()[Symbol.iterator]().next().done)e.set(r,new Set([r])),r.value=1;else{let i=new Set;for(let n of r.ichildren()){let s=M(e.get(n));for(let o of s)i.add(o)}e.set(r,i),r.value=i.size}return this}height(){for(let e of this.idescendants("after"))e.value=Math.max(0,...e.ichildren().map(r=>M(r.value)+1));return this}depth(){let e=new Map;for(let r of this)for(let i of r.ichildren()){let n=e.get(i);n?n.push(r):e.set(i,[r])}for(let r of this.idescendants("before"))r.value=Math.max(0,...(e.get(r)||[]).map(i=>M(i.value)+1));return this}*gsplit(){let e=new Map;for(let n of this)for(let s of n.ichildren()){let o=e.get(s);o?o.push(n):e.set(s,[n])}function*r(n){yield*n.ichildren(),yield*e.get(n)||[]}let i=new Set(this.iroots());for(let n of this.iroots()){if(!i.delete(n))continue;let s=[n];for(let o of st(r,n))i.delete(o)&&s.push(o);yield s.length>1?new K(s):s[0]}}isplit(){return N(this.gsplit())}split(){return[...this.isplit()]}connected(){let e=this.isplit()[Symbol.iterator](),{done:r}=e.next();return F(!r),{done:r}=e.next(),!!r}},ot=class extends K{data;dataChildren=[];constructor(e){super();this.data=e}iroots(){return N([this])}*gchildren(){for(let{child:e}of this.dataChildren)yield e}ichildren(){return N(this.gchildren())}children(){return[...this.ichildren()]}*gchildLinks(){for(let{child:e,data:r,points:i}of this.dataChildren)yield new ge(this,e,r,i)}ichildLinks(){return N(this.gchildLinks())}childLinks(){return[...this.ichildLinks()]}isplit(){return N([this])}split(){return[this]}connected(){return!0}};function Pt(t){if(typeof t!="string")throw new Error(`id is supposed to be string but got type ${typeof t}`);return t}function Dt(t){if(!t.length)throw new Error("dag contained no roots; this often indicates a cycle");for(let s of new K(t))if(new Set(s.ichildren()).size!==s.ichildren().length)throw new Error(U`node '${s.data}' contained duplicate children`);let e=new Set,r=new Set,i=null;function n(s){if(e.has(s))return[];if(r.has(s))return i=s,[s];{r.add(s);let o=[];for(let a of s.ichildren())if(o=n(a),o.length)break;return r.delete(s),e.add(s),o.length&&i!==null&&o.push(s),i===s&&(i=null),o}}for(let s of t){let o=n(s);if(o.length){let a=o.reverse().map(({data:h})=>U`'${h}'`).join(" -> ");throw new Error(`dag contained a cycle: ${a}`)}}}function dt(t){function e(s){if(!s.length)throw new Error("can't connect empty data");let o=new Map,a=new Set;for(let[u,l]of s.entries()){let f=Pt(t.sourceId(l,u)),c=o.get(f);c===void 0&&(c=new ot({id:f}),o.set(f,c));let v=Pt(t.targetId(l,u)),m=o.get(v);m===void 0&&(m=new ot({id:v}),o.set(v,m)),(f!==v||!t.single)&&(c.dataChildren.push(new ct(m,l)),a.add(v))}let h=[];for(let[u,l]of o.entries())a.has(u)||h.push(l);return Dt(h),h.length>1?new K(h):h[0]}function r(s){if(s===void 0)return t.sourceId;{let{sourceId:o,...a}=t;return dt({...a,sourceId:s})}}e.sourceId=r;function i(s){if(s===void 0)return t.targetId;{let{targetId:o,...a}=t;return dt({...a,targetId:s})}}e.targetId=i;function n(s){return s===void 0?t.single:dt({...t,single:s})}return e.single=n,e}function di(t){try{return typeof t[0]=="string"}catch{return!1}}function pi(t){if(di(t))return t[0];throw new Error(`default source id expected datum[0] to be a string but got datum: ${t}`)}function vi(t){try{return typeof t[1]=="string"}catch{return!1}}function gi(t){if(vi(t))return t[1];throw new Error(`default target id expected datum[1] to be a string but got datum: ${t}`)}function me(...t){if(t.length)throw new Error(`got arguments to connect(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as connect()(...)`);return dt({sourceId:pi,targetId:gi,single:!1})}function pt(t){function e(...s){if(!s.length)throw new Error("must pass in at least one node");let o=new Map,a=[];function h(m){let d=o.get(m);return d===void 0&&(d=new ot(m),o.set(m,d),a.push(d)),d}let u=s.map(h),l,f=0;for(;l=a.pop();)l.dataChildren=(t.childrenData(l.data,f++)||[]).map(([m,d])=>new ct(h(m),d));let c=new Set(u);for(let m of o.values())for(let d of m.ichildren())if(c.delete(d)&&t.roots)throw new Error(U`node '${m.data}' pointed to a root`);let v=c.size&&c.size!==u.length?[...c]:u;return Dt(v),v.length>1?new K(v):v[0]}function r(s){return s===void 0?t.children:pt({children:s,childrenData:ye(s),roots:t.roots})}e.children=r;function i(s){return s===void 0?t.childrenData:pt({children:mi(s),childrenData:s,roots:t.roots})}e.childrenData=i;function n(s){return s===void 0?t.roots:pt({...t,roots:s})}return e.roots=n,e}function ye(t){function e(r,i){return(t(r,i)||[]).map(n=>[n,void 0])}return e.wrapped=t,e}function mi(t){function e(r,i){return(t(r,i)||[]).map(([n])=>n)}return e.wrapped=t,e}function yi(t){try{let e=t.children;return e===void 0||e instanceof Array}catch{return!1}}function xe(t){if(yi(t))return t.children;throw new Error(U`default children function expected datum to have a children field but got: ${t}`)}function vt(...t){if(t.length)throw new Error(`got arguments to hierarchy(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as hierarchy()(...)`);return pt({children:xe,childrenData:ye(xe),roots:!0})}function gt(t){function e(s){if(!s.length)throw new Error("can't stratify empty data");let o=new Map;for(let[h,u]of s.entries()){let l=Pt(t.id(u,h)),f=t.parentData(u,h)||[],c=new ot(u);if(o.has(l))throw new Error(`found a duplicate id: ${r}`);o.set(l,[c,f])}let a=[];for(let[h,u]of o.values()){for(let[l,f]of u){let c=o.get(l);if(!c)throw new Error(`missing id: ${l}`);let[v]=c;v.dataChildren.push(new ct(h,f))}u.length||a.push(h)}return Dt(a),a.length>1?new K(a):a[0]}function r(s){if(s===void 0)return t.id;{let{id:o,...a}=t;return gt({...a,id:s})}}e.id=r;function i(s){if(s===void 0)return t.parentData;{let{parentIds:o,parentData:a,...h}=t;return gt({...h,parentIds:xi(s),parentData:s})}}e.parentData=i;function n(s){if(s===void 0)return t.parentIds;{let{parentIds:o,parentData:a,...h}=t;return gt({...h,parentIds:s,parentData:be(s)})}}return e.parentIds=n,e}function be(t){function e(r,i){return(t(r,i)||[]).map(n=>[n,void 0])}return e.wrapped=t,e}function xi(t){function e(r,i){return(t(r,i)||[]).map(([n])=>n)}return e.wrapped=t,e}function bi(t){try{return typeof t.id=="string"}catch{return!1}}function wi(t){if(bi(t))return t.id;throw new Error(U`default id function expected datum to have an id field but got '${t}'`)}function _i(t){try{let e=t.parentIds;return e===void 0||e instanceof Array&&e.every(r=>typeof r=="string")}catch{return!1}}function we(t){if(_i(t))return t.parentIds;throw new Error(`default parentIds function expected datum to have a parentIds field but got: ${t}`)}function _e(...t){if(t.length)throw new Error(`got arguments to stratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as stratify()(...)`);return gt({id:wi,parentIds:we,parentData:be(we)})}function Ii(t){if(t.value===void 0)throw new Error(U`node with data '${t.data}' did not get a defined value during layering`);if(t.value<0)throw new Error(U`node with data '${t.data}' got an invalid (negative) value during layering: ${t.value}`);return t.value}function Ie(t){let e=new Map(t.idescendants().map(s=>[s,{node:s,layer:Ii(s)}]));function r(s){let o=s.layer+1,a="node"in s?s.node.children():[s.target],h="node"in s?s.node:s.source;return a.map(u=>{let l=M(e.get(u));if(l.layer<o)throw new Error(U`layering left child data '${u.data}' (${u.value}) with greater or equal layer to parent data '${h.data}' (${h.value})`);return l.layer===o?l:{source:h,target:u,layer:o}})}let i=vt().children(r)(...t.iroots().map(s=>M(e.get(s)))),n=[];for(let s of i)(n[s.data.layer]||(n[s.data.layer]=[])).push(s);if(!n[0]||!n[0].length)throw new Error("no nodes were assigned to layer 0");for(let s of n)F(s&&s.length);return n}var Pe=rt($e());function qi(t,e,r,i,n){if(!e.length)return[];let s=[[0]],o=[0],a=[[0]],h=[0];for(let f of t){let c=[0];c.push(...f),s.push(c)}o.push(...e),a.push(...e.map(()=>[0]));for(let f of r)for(let[c,v]of f.entries())a[c+1].push(-v);h.push(...i.map(f=>-f));let{solution:u,message:l}=(0,Pe.solveQP)(s,o,a,h,n);return F(!l.length),u.shift(),u}function mt(t,e,r,i,n=0){e.pop(),t.pop(),t.forEach(o=>o.pop()),r.forEach(o=>o.pop());let s=qi(t,e,r,i,n);return s.push(0),s}function De(t){return new Map(t.flatMap(e=>e).map((e,r)=>[e,r]))}function yt(t,e,r){let i=1+Math.max(...e.values()),n=[],s=[];for(let h of t)for(let[u,l]of W(h)){let f=M(e.get(u)),c=M(e.get(l)),v=new Array(i).fill(0);v[f]=1,v[c]=-1,n.push(v),s.push(-(r(u)+r(l))/2)}let o=new Array(i).fill(0);return[[...new Array(i)].map(()=>new Array(i).fill(0)),o,n,s]}function Lt(t,e,r,i){t[r][r]+=i,t[r][e]-=i,t[e][r]-=i,t[e][e]+=i}function xt(t,e,r,i,n){t[i][i]+=n,t[i][r]-=2*n,t[i][e]+=n,t[r][i]-=2*n,t[r][r]+=4*n,t[r][e]-=2*n,t[e][i]+=n,t[e][r]-=2*n,t[e][e]+=n}function bt(t,e,r,i){let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let o of t){let a=o[0],h=o[o.length-1];n=Math.min(n,i[M(r.get(a))]-e(a)/2),s=Math.max(s,i[M(r.get(h))]+e(h)/2)}for(let o of t)for(let a of o)a.x=i[M(r.get(a))]-n;return s-n}function Ai(t){let e=new Map;for(let s of t)for(let o of s)for(let a of o.ichildren()){let h=e.get(a);h?h.push(o):e.set(a,[o])}function*r(s){yield*s.ichildren(),yield*e.get(s)||[]}let i=0,n=new Map;for(let s of t)for(let o of s)if(!n.has(o)){for(let a of st(r,o))n.set(a,i);i++}return n}function Ti(t,e){let r=[],i=[],n=new Set;for(let s of t){let o=new Set(s.map(a=>M(e.get(a))));ve(n,o)||r.push(i=[]),i.push(s),n=o}return r}function wt(t){function e(o,a,h){let{vertNode:u,vertDummy:l,curveNode:f,curveDummy:c,comp:v}=t,m=De(o),[d,I,y,g]=yt(o,m,a);for(let _ of o)for(let w of _){let x=M(m.get(w)),E="node"in w.data?u:l;for(let C of w.ichildren()){let z=M(m.get(C)),j="node"in C.data?u:l,V="node"in C.data?f:c;Lt(d,x,z,E+j);for(let S of C.ichildren()){let O=M(m.get(S));xt(d,x,z,O,V)}}}for(let _ of o)for(let[w,x]of W(_))M(h.get(w))!==M(h.get(x))&&Lt(d,M(m.get(w)),M(m.get(x)),v);let b=mt(d,I,y,g);return bt(o,a,m,b)}function r(o,a){let{vertNode:h,vertDummy:u,curveNode:l,curveDummy:f}=t;if(h===0&&l===0)throw new Error("node vertical weight or node curve weight needs to be positive");if(u===0&&f===0)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");let c=Ai(o),v=Ti(o,c),m=v.map(I=>e(I,a,c)),d=Math.max(...m);if(d<=0)throw new Error("must assign nonzero width to at least one node");for(let[I,y]of v.entries()){let g=(d-m[I])/2;for(let b of y)for(let _ of b)_.x=M(_.x)+g}return d}function i(o){if(o===void 0){let{vertNode:u,vertDummy:l}=t;return[u,l]}let[a,h]=o;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return wt({...t,vertNode:a,vertDummy:h})}r.vertical=i;function n(o){if(o===void 0){let{curveNode:u,curveDummy:l}=t;return[u,l]}let[a,h]=o;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return wt({...t,curveNode:a,curveDummy:h})}r.curve=n;function s(o){if(o===void 0)return t.comp;if(o<=0)throw new Error(`weight must be positive, but was ${o}`);return wt({...t,comp:o})}return r.component=s,r}function _t(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return wt({vertNode:1,vertDummy:0,curveNode:0,curveDummy:1,comp:1})}var Mr=rt(Ot());function re(t){function e(n){let s={},o={},a={},h=new Map(n.idescendants().entries().map(([g,b])=>[b,g.toString()]));function u(g){return M(h.get(g))}function l(g){return s[u(g)]}function f(g,b,_,w=!0){let x=l(b),E=l(_),C=`${g}: ${M(u(b))} -> ${M(u(_))}`;a[C]={min:+w},x[C]=-1,E[C]=1}function c(g,b,_){f(`${g} before`,b,_,!1),f(`${g} after`,_,b,!1)}let v=[],m=new Map;for(let g of n){let b=u(g);o[b]=1,s[b]={opt:g.children.length};let _=t.rank(g);_!==void 0&&v.push([_,g]);let w=t.group(g);if(w!==void 0){let x=m.get(w);x?x.push(g):m.set(w,[g])}}for(let g of n.ilinks())f("link",g.source,g.target),++l(g.source).opt,--l(g.target).opt;let d=v.sort(([g],[b])=>g-b);for(let[[g,b],[_,w]]of W(d))g<_?f("rank",b,w):c("rank",b,w);for(let g of m.values())for(let[b,_]of W(g))c("group",b,_);let{feasible:I,...y}=Mr.Solve.call({},{optimize:"opt",opType:"max",constraints:a,variables:s,ints:o});if(!I)throw F(v.length||m.size),new Error("could not find a feasbile simplex layout, check that rank or group accessors are not ill-defined");for(let g of n)g.value=y[u(g)]||0}function r(n){if(n===void 0)return t.rank;{let{rank:s,...o}=t;return re({...o,rank:n})}}e.rank=r;function i(n){if(n===void 0)return t.group;{let{group:s,...o}=t;return re({...o,group:n})}}return e.group=i,e}function Cr(){}function qt(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return re({rank:Cr,group:Cr})}function jr(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function*Br(t,e){if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&(yield i)}}function At(t,e){let r;if(e===void 0)for(let i of t)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let n of t)(n=e(n,++i,t))!=null&&(r<n||r===void 0&&n>=n)&&(r=n)}return r}function Tt(t,e){let r;if(e===void 0)for(let i of t)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let n of t)(n=e(n,++i,t))!=null&&(r>n||r===void 0&&n>=n)&&(r=n)}return r}function Nt(t,e,r=0,i=t.length-1,n=jr){for(;i>r;){if(i-r>600){let h=i-r+1,u=e-r+1,l=Math.log(h),f=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*f*(h-f)/h)*(u-h/2<0?-1:1),v=Math.max(r,Math.floor(e-u*f/h+c)),m=Math.min(i,Math.floor(e+(h-u)*f/h+c));Nt(t,e,v,m,n)}let s=t[e],o=r,a=i;for(ft(t,r,e),n(t[i],s)>0&&ft(t,r,i);o<a;){for(ft(t,o,a),++o,--a;n(t[o],s)<0;)++o;for(;n(t[a],s)>0;)--a}n(t[r],s)===0?ft(t,r,a):(++a,ft(t,a,i)),a<=e&&(r=a+1),e<=a&&(i=a-1)}return t}function ft(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}function ie(t,e,r){if(t=Float64Array.from(Br(t,r)),!!(i=t.length)){if((e=+e)<=0||i<2)return Tt(t);if(e>=1)return At(t);var i,n=(i-1)*e,s=Math.floor(n),o=At(Nt(t,s).subarray(0,s+1)),a=Tt(t.subarray(s+1));return o+(a-o)*(n-s)}}function ne(t,e){return ie(t,.5,e)}var zr=class{mean=0;count=0;add(e){this.mean+=(e-this.mean)/++this.count}val(){return this.count?this.mean:void 0}},Er=()=>new zr,Vr=class{vals=[];add(e){this.vals.push(e)}val(){return ne(this.vals)}},se=()=>new Vr;function Xi(t,e){let r=t();for(let i of e)r.add(i);return r.val()}function Sr(t,e){let r=new Map;for(let l of t){let f=e.get(l);if(f===void 0)continue;let c=r.get(f);c===void 0?r.set(f,[l]):c.push(l)}let i=[...r.entries()].sort(([l],[f])=>l-f).flatMap(([,l])=>l),n=new Map(t.map((l,f)=>[l,f])),s=t.filter(l=>e.get(l)===void 0),o=new Array(s.length).fill(null);function a(l,f,c,v){if(f<=l)return;let m=Math.floor((l+f)/2),d=s[m],I=M(n.get(d)),y=0,g=[y];for(let _=c;_<v;++_)y+=M(n.get(i[_]))<I?-1:1,g.push(y);let b=c+g.indexOf(Math.min(...g));o[m]=b,a(l,m,c,b),a(m+1,f,b,v)}a(0,s.length,0,i.length),o.push(i.length+1);let h=0,u=0;for(let[l,f]of i.entries()){for(;o[u]==l;)t[h++]=s[u++];t[h++]=f}for(;o[u]==i.length;)t[h++]=s[u++]}function Or({factory:t}){function e(i,n,s){if(s){let o=new Map(n.map(h=>[h,t()]));for(let[h,u]of i.entries())for(let l of u.ichildren())M(o.get(l)).add(h);let a=new Map([...o.entries()].map(([h,u])=>[h,u.val()]));Sr(n,a)}else{let o=new Map(n.map((h,u)=>[h,u])),a=new Map(i.map(h=>{let u=Xi(t,h.ichildren().map(l=>M(o.get(l))));return[h,u]}));Sr(i,a)}}function r(i){return i===void 0?t:Or({factory:i})}return e.aggregator=r,e}function kt(...t){if(t.length)throw new Error(`got arguments to agg(${t}), but constructor takes no aruguments.`);return Or({factory:se})}function oe(t){function e(n){let s=n.slice().reverse(),o=!0;for(let a=0;a<t.passes&&o;++a){o=!1;for(let[h,u]of W(n)){let l=new Map(u.map((f,c)=>[f,c]));t.order(h,u,!0),u.some((f,c)=>M(l.get(f))!==c)&&(o=!0)}for(let[h,u]of W(s)){let l=new Map(u.map((f,c)=>[f,c]));t.order(u,h,!1),u.some((f,c)=>M(l.get(f))!==c)&&(o=!0)}}}function r(n){if(n===void 0)return t.order;{let{order:s,...o}=t;return oe({...o,order:n})}}e.order=r;function i(n){if(n===void 0)return t.passes;if(n<=0)throw new Error("number of passes must be positive");return oe({...t,passes:n})}return e.passes=i,e}function Rt(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return oe({order:kt(),passes:1})}function qr(t){let e=t();function r(i){return"node"in i.data?t(i.data.node):e}return r.wrapped=t,r}function Ki(t){let e=new Map;function r(s){let o=e.get(s);if(o===void 0){o=t(s);let[a,h]=o;if(a<0||h<0)throw new Error(U`all node sizes must be non-negative, but got width ${a} and height ${h} for node '${s}'`);e.set(s,o)}return o}return[s=>r(s)[0],s=>r(s)[1]]}function et(t){function e(h){t.layering(h);let u=Ie(h),[l,f]=Ki(t.sugiNodeSize),c=0;for(let m of u){let d=Math.max(...m.map(f));for(let I of m)I.y=c+d/2;c+=d}if(c<=0)throw new Error("at least one node must have positive height, but total height was zero");t.decross(u);let v=t.coord(u,l);for(let m of u)for(let d of m){if(d.x===void 0)throw new Error(U`coord didn't assign an x to node '${d}'`);if(d.x<0||d.x>v)throw new Error(`coord assgined an x (${d.x}) outside of [0, ${v}]`)}if(t.size!==null){let[m,d]=t.size;for(let I of u)for(let y of I)F(y.x!==void 0&&y.y!==void 0),y.x*=m/v,y.y*=d/c;v=m,c=d}for(let m of u)for(let d of m){if(F(d.x!==void 0&&d.y!==void 0),"target"in d.data)continue;d.data.node.x=d.x,d.data.node.y=d.y;let I=new Map(d.data.node.ichildLinks().map(({points:y,target:g})=>[g,y]));for(let y of d.ichildren()){let g=[{x:d.x,y:d.y}];for(;"target"in y.data;)F(y.x!==void 0&&y.y!==void 0),g.push({x:y.x,y:y.y}),[y]=y.ichildren();F(y.x!==void 0&&y.y!==void 0),g.push({x:y.x,y:y.y});let b=M(I.get(y.data.node));b.splice(0,b.length,...g)}}return{width:v,height:c}}function r(h){if(h===void 0)return t.layering;{let{layering:u,...l}=t;return et({...l,layering:h})}}e.layering=r;function i(h){if(h===void 0)return t.decross;{let{decross:u,...l}=t;return et({...l,decross:h})}}e.decross=i;function n(h){if(h===void 0)return t.coord;{let{coord:u,...l}=t;return et({...l,coord:h})}}e.coord=n;function s(h){return h!==void 0?et({...t,size:h}):t.size}e.size=s;function o(h){if(h!==void 0){let{nodeSize:u,sugiNodeSize:l,...f}=t;return et({...f,nodeSize:h,sugiNodeSize:qr(h)})}else return t.nodeSize}e.nodeSize=o;function a(h){if(h!==void 0){let{sugiNodeSize:u,nodeSize:l,...f}=t;return et({...f,sugiNodeSize:h,nodeSize:null})}else return t.sugiNodeSize}return e.sugiNodeSize=a,e}function Ar(t){return[+(t!==void 0),1]}function Tr(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return et({layering:qt(),decross:Rt(),coord:_t(),size:null,nodeSize:Ar,sugiNodeSize:qr(Ar)})}function Nr(...t){if(t.length)throw new Error(`got arguments to topological(${t}), but constructor takes no aruguments.`);function e(r){for(let[i,n]of r.idescendants("before").entries())n.value=i}return e}function kr(t){function e(i){if(t.topDown)i.depth();else{i.height();let n=Math.max(...i.iroots().map(s=>M(s.value)));for(let s of i)s.value=n-M(s.value)}}function r(i){return i===void 0?t.topDown:kr({...t,topDown:i})}return e.topDown=r,e}function Rr(...t){if(t.length)throw new Error(`got arguments to longestPath(${t}), but constructor takes no aruguments.`);return kr({topDown:!0})}var Dr=rt(Pr());function Fr(t){function e(i){let n=t.width||Math.floor(Math.sqrt(i.size()+.5)),s=new Map(i.idescendants().map(c=>[c,{before:[],parents:[]}]));for(let c of i)for(let v of c.ichildren())M(s.get(v)).parents.push(c);function o(c,v){let m=M(s.get(c)).before,d=M(s.get(v)).before;for(let[I,y]of m.entries()){let g=d[I];if(g===void 0)return!1;if(y<g)return!0;if(g<y)return!1}return!0}let a=new Dr.default(o);for(let c of i.iroots())a.add(c);let h=0,u=0,l=0,f;for(;f=a.poll();){l<n&&M(s.get(f)).parents.every(c=>M(c.value)<u)?(f.value=u,l++):(f.value=++u,l=1);for(let c of f.ichildren()){let{before:v,parents:m}=M(s.get(c));v.push(h),v.length===m.length&&(v.sort((d,I)=>I-d),a.add(c))}h++}}function r(i){if(i===void 0)return t.width;if(i<0)throw new Error(`width must be non-negative: ${i}`);return Fr({...t,width:i})}return e.width=r,e}function Lr(...t){if(t.length)throw new Error(`got arguments to coffmanGraham(${t}), but constructor takes no aruguments.`);return Fr({width:0})}var Ur=rt(Ot());function ae(t){function e(n){let s=n.reduce((g,b)=>g+b.length*Math.max(b.length-1,0)/2,0),o=n.reduce((g,b)=>g+b.reduce((_,w)=>_+w.ichildren().length,0),0);if(t.large!=="large"&&s>1200)throw new Error('size of dag to decrossOpt is too large and will likely crash instead of complete, enable "large" grahps to run anyway');if(t.large!=="large"&&t.large!=="medium"&&(s>400||o>100))throw new Error('size of dag to decrossOpt is too large and will likely not complete, enable "medium" grahps to run anyway');let a=[];for(let[g,b]of W(n)){let _=new Set(g.flatMap(j=>j.children())),w=b.filter(j=>!_.has(j)),x=g.map(j=>j.children()).filter(j=>j.length>1);a.push([w,x]);let E=g.filter(j=>!j.ichildren().length),C=new Map;for(let j of g)for(let V of j.ichildren()){let S=C.get(V);S?S.push(j):C.set(V,[j])}let z=[...C.values()];a.push([E,z])}let h=a.reduce((g,[b,_])=>_.reduce((w,x)=>w+x.length*x.length,0)*b.length,0)/4,u=1/(h+1),l=u/(s+1),f={optimize:"opt",opType:"min",constraints:{},variables:{},ints:{}},c=new Map;{let g=0;for(let b of n)for(let _ of b)c.set(_,g++)}function v(...g){return g.map(b=>M(c.get(b))).sort((b,_)=>b-_).join(" => ")}function m(g){for(let[b,_]of g.slice(0,g.length-1).entries())for(let w of g.slice(b+1)){let x=v(_,w);f.ints[x]=1,f.constraints[x]={max:1},f.variables[x]={opt:-l,[x]:1}}for(let[b,_]of g.slice(0,g.length-1).entries())for(let[w,x]of g.slice(b+1).entries())for(let E of g.slice(b+w+2)){let C=v(_,x),z=v(_,E),j=v(x,E),V=v(_,x,E),S=V+"+";f.constraints[S]={max:1},f.variables[C][S]=1,f.variables[z][S]=-1,f.variables[j][S]=1;let O=V+"-";f.constraints[O]={min:0},f.variables[C][O]=1,f.variables[z][O]=-1,f.variables[j][O]=1}}function d(g){for(let[b,_]of g.slice(0,g.length-1).entries())for(let w of g.slice(b+1)){let x=v(_,w);for(let E of _.ichildren())for(let C of w.ichildren()){if(E===C)continue;let z=v(E,C),j=`slack (${x}) (${z})`,V=`${j} +`,S=`${j} -`;f.variables[j]={opt:1,[V]:1,[S]:1};let O=Math.sign(M(c.get(E))-M(c.get(C))),T=Math.max(O,0);f.constraints[V]={min:T},f.variables[x][V]=1,f.variables[z][V]=O,f.constraints[S]={min:-T},f.variables[x][S]=-1,f.variables[z][S]=-O}}}function I(g,b){for(let _ of g)for(let w of b)for(let[x,E]of w.entries())for(let C of w.slice(x+1)){let j=`dist ${[E,_,C].map(T=>M(c.get(T))).join(" => ")}`,V=`${j} normal`,S=`${j} reversed`;f.variables[j]={opt:u,[V]:1,[S]:1};let O=0;for(let[T,$]of[[E,_],[E,C],[_,C]]){let q=v(T,$),G=Math.sign(M(c.get(T))-M(c.get($)));O+=+(G>0),f.variables[q][V]=-G,f.variables[q][S]=G}f.constraints[V]={min:1-O},f.constraints[S]={min:O-2}}}for(let g of n)m(g);for(let g of n.slice(0,n.length-1))d(g);if(t.dist)for(let[g,b]of a)I(g,b);let y=Ur.Solve.call({},f);for(let g of n)g.sort((b,_)=>y[v(b,_)]||-1)}function r(n){return n===void 0?t.large:ae({...t,large:n})}e.large=r;function i(n){return n===void 0?t.dist:ae({...t,dist:n})}return e.dist=i,e}function Gr(...t){if(t.length)throw new Error(`got arguments to opt(${t}), but constructor takes no aruguments.`);return ae({large:"small",dist:!1})}function Wr(...t){if(t.length)throw new Error(`got arguments to center(${t}), but constructor takes no aruguments.`);function e(r,i){let n=r.map(o=>{let a=0;for(let h of o){let u=i(h);h.x=a+u/2,a+=u}return a}),s=Math.max(...n);if(s<=0)throw new Error("must assign nonzero width to at least one node");for(let[o,a]of r.entries()){let h=n[o],u=(s-h)/2;for(let l of a)l.x=M(l.x)+u}return s}return e}function Hr(...t){if(t.length)throw new Error(`got arguments to greedy(${t}), but constructor takes no aruguments.`);function e(r,i){let n=tn,s=new Map;for(let f of r)for(let c of f)s.set(c,c.ichildren().length+("node"in c.data?0:-3));for(let f of r)for(let c of f)for(let v of c.ichildren())s.set(v,M(s.get(v))+1);let[o,...a]=r,h=0,u=0;for(let f of o){let c=i(f);f.x=u+c/2,u+=c}for(let f of a){n(o,f);let c=f.map((v,m)=>[m,v]).sort(([v,m],[d,I])=>{let y=M(s.get(m)),g=M(s.get(I));return y===g?v-d:g-y});for(let[v,m]of c){let d=i(m),I=M(m.x)+d/2;for(let g of f.slice(v+1)){let b=i(g)/2;I=(g.x=Math.max(M(g.x),I+b))+b}u=Math.max(u,I);let y=M(m.x)-d/2;for(let g of f.slice(0,v).reverse()){let b=i(g)/2;y=(g.x=Math.min(M(g.x),y-b))-b}h=Math.min(h,y)}o=f}for(let f of r)for(let c of f)c.x=M(c.x)-h;let l=u-h;if(l<=0)throw new Error("must assign nonzero width to at least one node");return l}return e}function tn(t,e){for(let i of e)i.x=0;let r=new Map;for(let i of t){F(i.x!==void 0);for(let n of i.ichildren()){F(n.x!==void 0);let s=(r.get(n)||0)+1;r.set(n,s),n.x+=(i.x-n.x)/s}}}function Jr(...t){if(t.length)throw new Error(`got arguments to topological(${t}), but constructor takes no aruguments.`);function e(r,i){for(let c of r)if(c.reduce((m,d)=>m+ +("node"in d.data),0)!==1)throw new Error("topological() only works with a topological layering");let n=new Map,s=0;for(let c of r)for(let v of c)"target"in v.data&&n.set(v,s++);for(let c of r)for(let v of c)"node"in v.data&&n.set(v,s);let[o,a,h,u]=yt(r,n,i);for(let c of r)for(let v of c){let m=M(n.get(v));for(let d of v.ichildren()){let I=M(n.get(d));if("target"in d.data)for(let y of d.ichildren()){let g=M(n.get(y));xt(o,m,I,g,1)}}}let l=mt(o,a,h,u),f=bt(r,i,n,l);if(f<=0)throw new Error("must assign nonzero width to at least one node");return f}return e}var Zr=rt(Ot());function he(t){function e(n,s,o){let a=o?s:n,h=a.length*Math.max(a.length-1,0)/2,u=n.reduce((w,x)=>w+x.ichildren().length,0);if(t.large!=="large"&&h>1200)throw new Error('size of dag to twolayerOpt is too large and will likely crash, enable "large" dags to run anyway');if(t.large!=="large"&&t.large!=="medium"&&(h>400||u>100))throw new Error('size of dag to twolayerOpt is too large and will likely not finish, enable "medium" dags to run anyway');let l={optimize:"opt",opType:"min",constraints:{},variables:{},ints:{}},f=new Map(a.map((w,x)=>[w,x]));function c(...w){return w.map(x=>M(f.get(x))).sort((x,E)=>x-E).join(" => ")}let v,m;if(o){let w=new Set(n.flatMap(x=>x.children()));v=s.filter(x=>!w.has(x)),m=n.map(x=>x.children()).filter(x=>x.length>1)}else{v=n.filter(x=>!x.ichildren().length);let w=new Map;for(let x of n)for(let E of x.ichildren()){let C=w.get(E);C?C.push(x):w.set(E,[x])}m=[...w.values()]}let I=m.reduce((w,x)=>w+x.length*x.length,0)*v.length/4,y=1/(I+1),g=y/(h+1),b=new Map(s.map((w,x)=>[w,x]));for(let[w,x]of a.slice(0,a.length-1).entries())for(let E of a.slice(w+1)){let C=c(x,E);l.ints[C]=1,l.constraints[C]={max:1},l.variables[C]={opt:-g,[C]:1}}for(let[w,x]of a.slice(0,a.length-1).entries())for(let[E,C]of a.slice(w+1).entries())for(let z of a.slice(w+E+2)){let j=c(x,C),V=c(x,z),S=c(C,z),O=c(x,C,z),T=O+"+";l.constraints[T]={max:1},l.variables[j][T]=1,l.variables[V][T]=-1,l.variables[S][T]=1;let $=O+"-";l.constraints[$]={min:0},l.variables[j][$]=1,l.variables[V][$]=-1,l.variables[S][$]=1}for(let[w,x]of n.slice(0,n.length-1).entries())for(let E of n.slice(w+1))for(let C of x.ichildren())for(let z of E.ichildren()){if(C===z)continue;let j=o?c(C,z):c(x,E);l.variables[j].opt+=Math.sign(M(b.get(C))-M(b.get(z)))}if(t.dist)for(let w of v)for(let x of m)for(let[E,C]of x.entries())for(let z of x.slice(E+1)){let V=`dist ${[C,w,z].map($=>M(f.get($))).join(" => ")}`,S=`${V} normal`,O=`${V} reversed`;l.variables[V]={opt:y,[S]:1,[O]:1};let T=0;for(let[$,q]of[[C,w],[C,z],[w,z]]){let G=c($,q),L=Math.sign(M(f.get($))-M(f.get(q)));T+=+(L>0),l.variables[G][S]=-L,l.variables[G][O]=L}l.constraints[S]={min:1-T},l.constraints[O]={min:T-2}}let _=Zr.Solve.call({},l);a.sort((w,x)=>_[c(w,x)]||-1)}function r(n){return n===void 0?t.large:he({...t,large:n})}e.large=r;function i(n){return n===void 0?t.dist:he({...t,dist:n})}return e.dist=i,e}function Yr(...t){if(t.length)throw new Error(`got arguments to opt(${t}), but constructor takes no aruguments.`);return he({large:"small",dist:!1})}function Xr(t,e){let r=t.findIndex(i=>i<=e);return r>=0?r:t.length}function Kr(t){let e=new Map(t.map((o,a)=>[o,a])),r=[];for(let[o,a]of t.entries())for(let h of a.ichildren()){let u=M(e.get(h));u>o+1&&r.push([a,o,h,u])}r.sort(([,o,,a],[,h,,u])=>a===u?h-o:a-u);let i=new Map,n=[],s=[];for(let[o,a,h,u]of r){let l=i.get(o);l===void 0&&(l=new Map,i.set(o,l));let f=Xr(s,a),c=Xr(n,a);f<c?(l.set(h,-f-1),s[f]=u-1):(l.set(h,c+1),n[c]=u-1)}return i}function Qr(t,e){function r(n){let s=[...n.idescendants("before")],o=s.length-1;if(o===0){let[f]=s;f.x=t/2,f.y=e/2;return}let a=Kr(s),h=-1,u=1;for(let{source:f,target:c}of n.ilinks()){let v=a.get(f)?.get(c);v!==void 0&&(h=Math.min(h,v),u=Math.max(u,v))}let l=e/o;for(let[f,c]of s.entries())c.x=-h*t/(u-h),c.y=f*l;for(let{source:f,target:c,points:v}of n.ilinks()){v.length=0,F(f.x!==void 0&&f.y!==void 0),F(c.x!==void 0&&c.y!==void 0),v.push({x:f.x,y:f.y});let m=a.get(f)?.get(c);if(m!==void 0){let d=(m-h)/(u-h)*t,I=f.y+l,y=c.y-l;y-I>l/2?v.push({x:d,y:I},{x:d,y}):v.push({x:d,y:I})}v.push({x:c.x,y:c.y})}}function i(n){if(n===void 0)return[t,e];{let[s,o]=n;return Qr(s,o)}}return r.size=i,r}function ti(...t){if(t.length)throw new Error(`got arguments to zherebko(${t}), but constructor takes no aruguments.`);return Qr(1,1)}return en;})();
return d3; })())
